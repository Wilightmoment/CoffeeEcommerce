(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d547785"],{6090:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("Loading",{attrs:{isloading:t.isloading}}),e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-md-8"},[e("div",{staticClass:"accordion mb-3",attrs:{id:"accordionExample"}},[e("div",{staticClass:"card border-0"},[t._m(0),e("div",{staticClass:"collapse show",attrs:{id:"collapseOne","aria-labelledby":"headingOne","data-parent":"#accordionExample"}},[e("h2",[t._v("購物車明細")]),e("table",{staticClass:"table"},[t._m(1),e("tbody",t._l(t.carts,function(a){return e("tr",{key:a.id},[e("td",{staticClass:"align-middle"},[e("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:function(e){t.removeCartItem(a.id)}}},[e("i",{staticClass:"far fa-trash-alt"})])]),e("td",{staticClass:"align-middle"},[t._v("\n                      "+t._s(a.product.title)+"\n                      "),a.coupon?e("div",{staticClass:"text-success"},[t._v("\n                        已套用優惠券\n                      ")]):t._e()]),e("td",{staticClass:"align-middle"},[t._v(t._s(a.qty)+"/"+t._s(a.product.unit))]),e("td",{staticClass:"align-middle text-right"},[t._v(t._s(t._f("currency")(a.final_total)))])])})),e("tfoot",[e("tr",[e("td",{staticClass:"text-right",attrs:{colspan:"3"}},[t._v("總計")]),e("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.cash.total)))])]),t.cash.finaltotal!==t.cash.total?e("tr",[e("td",{staticClass:"text-right text-success",attrs:{colspan:"3"}},[t._v("折扣價")]),e("td",{staticClass:"text-right text-success"},[t._v(t._s(t._f("currency")(t.cash.finaltotal)))])]):t._e()])]),e("div",{staticClass:"input-group mb-3 input-group-sm"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.coupon_code},on:{keyup:function(a){return"button"in a||!t._k(a.keyCode,"enter",13,a.key,"Enter")?t.addCoupon(a):null},input:function(a){a.target.composing||(t.coupon_code=a.target.value)}}}),e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:t.addCoupon}},[t._v("\n                    套用優惠碼\n                  ")])])])])])]),t._m(2),e("form",{staticClass:"mt-3",on:{submit:function(a){return a.preventDefault(),t.createOrder(a)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"useremail"}},[t._v("Email")]),e("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"},{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("email")},attrs:{type:"email",name:"email",id:"useremail",placeholder:"請輸入 Email"},domProps:{value:t.form.user.email},on:{input:function(a){a.target.composing||t.$set(t.form.user,"email",a.target.value)}}}),t.errors.has("email")?e("span",{staticClass:"text-danger"},[t._v(t._s(t.errors.first("email")))]):t._e()]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"username"}},[t._v("收件人姓名")]),e("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("name")},attrs:{type:"text",name:"name",id:"username",placeholder:"輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(a){a.target.composing||t.$set(t.form.user,"name",a.target.value)}}}),t.errors.has("name")?e("span",{staticClass:"text-danger"},[t._v("姓名必須輸入")]):t._e()]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"usertel"}},[t._v("收件人電話")]),e("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|numeric",expression:"'required|numeric'"},{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("phone")},attrs:{type:"tel",id:"usertel",name:"phone",placeholder:"請輸入電話"},domProps:{value:t.form.user.tel},on:{input:function(a){a.target.composing||t.$set(t.form.user,"tel",a.target.value)}}}),t.errors.has("phone")?e("span",{staticClass:"text-danger"},[t._v("電話欄位格式錯誤")]):t._e()]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"useraddress"}},[t._v("收件人地址")]),e("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("address")},attrs:{type:"address",name:"address",id:"useraddress",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(a){a.target.composing||t.$set(t.form.user,"address",a.target.value)}}}),t.errors.has("address")?e("span",{staticClass:"text-danger"},[t._v("地址欄位不得留空")]):t._e()]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"form_message"}},[t._v("留言")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"",id:"form_message",cols:"30",rows:"10"},domProps:{value:t.form.message},on:{input:function(a){a.target.composing||t.$set(t.form,"message",a.target.value)}}})]),e("div",{staticClass:"text-right"},[e("button",{staticClass:"btn btn-secondary mr-1",attrs:{type:"button"},on:{click:t.goback}},[t._v("繼續選購")]),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("確認付款")])])])])])])],1)},r=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"card-header bg-transparent pl-0",attrs:{id:"headingOne"}},[e("h4",{staticClass:"mb-0"},[e("button",{staticClass:"btn btn-link pl-0",attrs:{type:"button","data-toggle":"collapse","data-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"}},[t._v("\n                  顯示/隱藏 訂單資料\n                ")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("th"),e("th",[t._v("品名")]),e("th",[t._v("數量")]),e("th",[t._v("單價")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"bg-light py-2 text-center"},[e("div",{staticClass:"h2"},[t._v("訂購人資訊")])])}],i=(e("ac6a"),e("cadf"),e("551c"),e("097d"),{data:function(){return{carts:[],isloading:!1,cash:{total:0,finaltotal:0},coupon_code:"",couponed:!0,form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts:function(){var t="".concat("https://vue-course-api.hexschool.io","/api/").concat("royal","/cart"),a=this;a.isloading=!0,a.cash.total=0,a.cash.finaltotal=0,this.axios.get(t).then(function(t){t.data.success&&(a.carts=t.data.data.carts,a.carts.forEach(function(t){a.cash.total+=t.total,a.cash.finaltotal+=t.final_total}),a.isloading=!1)})},removeCartItem:function(t){var a=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("royal","/cart/").concat(t);a.isloading=!0,this.axios.delete(e).then(function(t){t.data.success?(a.isloading=!1,a.getCarts()):(a.$bus.$emit("message:push","刪除失敗","warning"),a.isloading=!1)})},addCoupon:function(){var t="".concat("https://vue-course-api.hexschool.io","/api/").concat("royal","/coupon"),a=this,e={code:a.coupon_code};a.isloading=!0,this.axios.post(t,{data:e}).then(function(t){t.data.success||(a.$bus.$emit("message:push",t.data.message,"danger"),a.couponed=!1),a.coupon_code="",a.getCarts(),a.isloading=!1})},createOrder:function(){var t=this,a=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("royal","/order"),s=a.form;this.$validator.validate().then(function(a){a&&t.axios.post(e,{data:s}).then(function(a){a.data.success?t.$router.push("/index/checkout/".concat(a.data.orderId)):t.$bus.$emit("message:push",a.data.message,"danger")})})},goback:function(){this.$router.go(-1)}},created:function(){this.getCarts()}}),o=i,n=e("2877"),l=Object(n["a"])(o,s,r,!1,null,null,null);l.options.__file="CartPaid.vue";a["default"]=l.exports},ac6a:function(t,a,e){for(var s=e("cadf"),r=e("0d58"),i=e("2aba"),o=e("7726"),n=e("32e9"),l=e("84f2"),c=e("2b4c"),d=c("iterator"),u=c("toStringTag"),m=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=r(p),f=0;f<v.length;f++){var g,h=v[f],_=p[h],C=o[h],b=C&&C.prototype;if(b&&(b[d]||n(b,d,m),b[u]||n(b,u,h),l[h]=m,_))for(g in s)b[g]||i(b,g,s[g],!0)}}}]);
//# sourceMappingURL=chunk-7d547785.e48f4c8b.js.map